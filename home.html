
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test</title>
</head>
<body>
    <input id="teste" type="button" value="Imprimir Teste" style="width: 50%;">
    <ul id="list">
        <li>resultados:</li>
    </ul>
    <script>
        document.querySelector('#teste').addEventListener('click', testeImpressora)

        function addLi(text) {
            let ul = document.getElementById("list");
            let li = document.createElement("li");
            li.appendChild(document.createTextNode(text));
            ul.appendChild(li);
        }

        function testeImpressora() {
            addLi('bora lá')
            let args = JSON.stringify({ tipo: 5, modelo: '', conexao: '', parametro: 0 })
            let result = Termica.AbreConexaoImpressora(args)
            addLi('abreconexaoimpressora')
            addLi(`result: ${result}`)
            let resultJson = JSON.parse(result)
            if (resultJson.callResult === 'success') {
                if (resultJson.callReturn !== 0) {
                    addLi(`Retorno: ${resultJson.callReturn}`)
                } else addLi(resultJson.callReturn)
            } else {
                addLi(`Failed\nCall Result Code: ${resultJson.callResultCode}\nCall Return: ${resultJson.callReturn}`)
            }
    
    
            args = JSON.stringify({ dados: 'qualquer coisa só pra teste',
                                    alinhamento: 0,
                                    stilo: 0, 
                                    tamanho: 17 })
            result = Termica.ImpressaoTexto(args)
            addLi('impressao texto')
            addLi(`result: ${result}`)
            resultJson = JSON.parse(result)
            if (resultJson.callResult === 'success') {
                if (resultJson.callReturn !== 0) {
                    alert(`Retorno: ${resultJson.callReturn}`)
                } else alert(resultJson.callReturn)
            } else {
                alert(`Failed\nCall Result Code: ${resultJson.callResultCode}\nCall Return: ${resultJson.callReturn}`)
            }
    
            result = Termica.Corte(10)
            addLi('corte')
            addLi(`result: ${result}`)
            resultJson = JSON.parse(result)
            if (resultJson.callResult === 'success') {
                if (resultJson.callReturn !== 0) {
                    alert(`Retorno: ${resultJson.callReturn}`)
                } else alert(resultJson.callReturn)
            } else {
                alert(`Failed\nCall Result Code: ${resultJson.callResultCode}\nCall Return: ${resultJson.callReturn}`)
            }
    
            result = Termica.FechaConexaoImpressora()
            addLi('fecha')
            addLi(`result: ${result}`)
            resultJson = JSON.parse(result)
            if (resultJson.callResult === 'success') {
                if (resultJson.callReturn !== 0) {
                    alert(`Retorno: ${resultJson.callReturn}`)
                } else alert(resultJson.callReturn)
            } else {
                alert(`Failed\nCall Result Code: ${resultJson.callResultCode}\nCall Return: ${resultJson.callReturn}`)
            }
        }
    </script>
</body>
</html>